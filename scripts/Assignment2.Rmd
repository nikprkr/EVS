---
title: "Report"
author: "Nick Parker"
date: "3/13/2022"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Project Description

This project explores how sex, religious affiliation, and income influence how respondents answer questions meant to assess their perspectives on two issues: whether the children of mothers who work for pay suffer and whether when jobs are scarce, employers should give priority to citizens of a country over immigrants. The data used in this analysis was generated as part of the 2017 European Value Study (EVS). The EVS is described as "a large-scale, cross-national and longitudinal survey research program on how Europeans think about family, work, religion, politics, and society. Repeated every nine years in an increasing number of countries, the survey provides insights into the ideas, beliefs, preferences, attitudes, values, and opinions of citizens all over Europe."



## Descriptive Statistics

```{r cars, echo=FALSE, message=FALSE}

library(tidyverse)
library(haven)
library(psych)


data <- read_dta("/Users/nicholasparker/Dropbox/JPSM/MWDS/EVS/ZA7500_v4-0-0.dta")

data_clean <- data %>%
  select(v72,v80,v52,v261,v243_r,c_abrv,v225, age) %>%
  rename("suffering_mother"=v72) %>%
  rename("jobs_scarce"= v80) %>%
  rename("religion"= v52) %>%
  rename("sex"= v225) %>%
  rename("education"= v243_r) %>%
  rename("country"= c_abrv) %>%
  rename("income" = v261)

```

```{r , echo=FALSE, include=TRUE}

data_continuous <- data_clean %>%
  select(income, age)

data_categorical <- data_clean %>%
  select(-income, -age)

table_continuous <- describe(data_continuous)

table_categorical <- summary(data_categorical)

library(knitr)

table_categorical <- summary(data_categorical)

knitr::kable(table_continuous)

knitr::kable(table_categorical)


## Create age deciles

data_clean_age<- data_clean %>%
  select(age,suffering_mother,jobs_scarce)

data_clean_age_summary<- data_clean_age %>%
  group_by(age) %>%
  summarise(mean_suffering_mother = mean(suffering_mother)) %>%
  filter(age>0)

data_clean_religion_summary<- data_clean %>%
  group_by(religion) %>%
  summarise(mean_religion = mean(jobs_scarce)) %>%
  filter(religion>0) 

data_clean_religion_summary$religion <- c("Roman Catholic","Protestant", "Free Church/Nonconfirmist/Evangelical", "Jew", "Muslim", "Hindu", "Buddhist", "Orthodox", "Other")

data_clean_religion_summary$religion<- recode(data_clean_religion_summary$religion,'1'='Roman Catholic')

  
ggplot(data = data_clean_age_summary, aes(age,mean_suffering_mother))+
  theme_minimal()+
  geom_point() +
  xlab("age") +
  ylab("mean response value")

ggplot(data = data_clean_religion_summary, aes(mean_religion, religion))+
  theme_minimal()+
  geom_point() +
  xlab("mean response value") +
  ylab("religion")+
  theme(axis.text.x = element_text(angle=90,vjust=0.5))

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
